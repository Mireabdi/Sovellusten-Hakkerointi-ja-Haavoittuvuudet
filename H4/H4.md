### Sovellusten Hakkerointi ja Haavoittuvaisuudet

## ICI012AS3A

## Abdirahman Mire

# H4 Kääntöpaikka

### Työympäristö:

Käyttöjärjestelmä: Windows 11 Pro 64-bit

CPU: Intel Core i7-12700KF - 4 cores in use

RAM: 6 GB DDR4

Disk: 80gb

Virtuaalikone: VMware, Kali Linux

## X) Hammond 2022

- Video näyttää, miten PicoCTF bbbloat -binääri analysoidaan Ghidralla.
  
- Näytetään funktioiden, merkkijonojen ja obfuskaation tutkiminen ilman lähdekoodia.
  
- Lopuksi selitetään, miten ohjelman logiikasta päätellen voidaan löytää oikea syöteen tai lippu.


## A) Ghidra

Asensin Ghidran:

'sudo apt-get install ghidra' 

'sudo apt-get install openjdk-17-jdk'

## B) rever-C

Avattuani ghidran aloitin uuden projektin ja importtasin packd-binäärin. 

![kuva1](/H4/kuvat/kuva1.png)

Tämän jälkeen avasin Ghidrassa CodeBrowserin ja analysoin Packd binäärin. Etsin main-funktion functions välilehdeltä: 

![kuva1](/H4/kuvat/kuva2.png)

Tässä kohtaan jäin jumiin, en ole varma miten tästä pitäisi ratkaista tehtävä. yritän parhaani mukaan selittää miten ohjelma toimii.

![kuva1](/H4/kuvat/kuva4.png)

Sain tämän verran nimettyä mutta näyttää siltä että käyttäjältä kysytään syötettä jonka jälkeen syötettä verrataan salasanaan jonka jälkeen oikean tai väärän syötteen vertailun jälkeen tulostetaan jotain.

## C) väärinpäin passtr

Aloitin tekemällä uuden projektin ja importtasin passtr. etsin main funktion:

![kuva1](/H4/kuvat/kuva5.png)

Etsin if funktion sijainnin listingissä:

![kuva1](/H4/kuvat/kuva6.png)

Oikea klikki JNZ ja valitsin Patch instruction. Poistin N kirjaimen JNZ:sta. 

Poistamalla binääristä JNZ-käskyn käänsin ehtolauseen logiikan: ohjelma ei enää hyväksy oikeaa salasanaa, mutta kaikki muut syötteet hyväksytään.

![kuva1](/H4/kuvat/kuva7.png)

Tallensin uuden version  Export program -> format: original File.

Ajoin uuden version ohjelmasta: 

![kuva1](/H4/kuvat/kuva9.png)

## D) Nora CrackMe

### crackme01

Latasin NoraCodes CrackMe, jonka jälkeen `unzip  crackmes-master.zip`

![kuva1](/H4/kuvat/kuva11.png)

Tämän jälkeen crackme auki ghidrassa ja symbol tree:stä etsin main: 

![kuva1](/H4/kuvat/kuva12.png)

Annoin muuttujille kuvaavat nimet:

param_1 -> argc

param_2 -> argv

iVar1 -> cmp_result

![kuva1](/H4/kuvat/kuva13.png)

Ohjelma tarkistaa, että komentorivillä on yksi argumentti ja vertaa sitä merkkijonoon "password1". Jos syöte täsmää, tulostetaan `Yes, password1 is correct!`, muuten `Need exactly one argument.`

![kuva1](/H4/kuvat/kuva14.png)

### crackme01e

Samallalailla ghidrassa crackme01e auki ja suunnistus mainiin:

![kuva1](/H4/kuvat/kuva15.png)

Nimesin: 

param_1 -> argc

param_2 -> argptr

iVar1 -> cmp_result

![kuva1](/H4/kuvat/kuva16.png)

Ohjelma tarkistaa, että komentorivillä on yksi argumentti, vertaa sitä merkkijonoon "slm!paas.k" ja tulostaa sen mukaan:

Oikea syöte: Yes, <syöte> is correct!

Väärä syöte: No, <syöte> is not correct.

Väärä määrä argumentteja: Need exactly one argument.

![kuva1](/H4/kuvat/kuva17.png)

### Crackme02

jälleen kerran Crackme02 auki ghidrassa ja suunnistus mainiin: 

![kuva1](/H4/kuvat/kuva18.png)

Niemsin seuraavasti: 

param_1 -> argc

param_2 -> argv

uVar1 -> ret_val

![kuva1](/H4/kuvat/kuva19.png)

Ymmärsin, että ohjelman pääfunktiossa on for-silmukka if-lauseen sisällä, joka käy läpi syötteen merkit verraten niitä oikeaan merkkijonoon. 

En täysin hahmota kaikkia yksityiskohtia, uskoin että oikea salasana binäärin perusteella on "password1". Tämä osoittautui vääräksi: 

![kuva1](/H4/kuvat/kuva20.png)


### Referenssit

https://terokarvinen.com/sovellusten-hakkerointi/

https://github.com/NoraCodes/crackmes?tab=readme-ov-file

https://nora.codes/tutorial/an-intro-to-x86_64-reverse-engineering/

https://www.youtube.com/watch?v=oTD_ki86c9I
